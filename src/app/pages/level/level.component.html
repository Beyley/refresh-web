<page-header-block>
  <div class="flex gap-3.5">
    <img src="{{GetAssetImageLink(level?.iconHash)}}" class="inline rounded-full h-auto w-44 object-cover aspect-square">
    <div>
      <page-header class="text-3xl">
        {{ level?.title ?? 'Unnamed Level' }}
        <div class="inline-block text-sm font-normal">
          <span-gentle>by <user-link [user]="level!.publisher" class="pl-1"></user-link></span-gentle>
        </div>
        <div class="text-sm font-normal">
          <span-gentle>Published {{ getMoment(level?.publishDate ?? 0) }}</span-gentle>
          <span-gentle *ngIf="level?.publishDate != level?.updateDate">, updated {{ getMoment(level?.updateDate ?? 0)}}</span-gentle>
        </div>
      </page-header>

      <div class="bg-backdrop rounded-[11px] p-2.5">
        <p *ngIf="(level?.description?.length ?? 0) > 0">{{level?.description}}</p>
        <p *ngIf="(level?.description?.length ?? 0) === 0">No description was provided for this level.</p>
      </div>
    </div>
  </div>
</page-header-block>

<div class="bg-form-background rounded-[11px] p-5 mt-5">
    <page-header class="text-3xl">Leaderboard</page-header>
    <div class="pt-2.5">
        <form-dropdown name="Score Type" [options]="scoreTypes" [id]="this.scoreTypeId"
            (change)="this.formChanged()"></form-dropdown>
    </div>
    <divider></divider>
    <div *ngIf="scores === undefined">
        <p>Loading scores...</p>
    </div>
    <div *ngIf="scores !== undefined && scores!.length === 0">
        <p>Nobody's played this level in this mode yet. Go for the top score!</p>
    </div>
    <div *ngFor="let score of scores">
        <div class="my-5 px-2.5">
            <a [routerLink]="'/score/' + score.scoreId" class="flex items-center">
                <div class="text-2xl">
                    <span *ngIf="score.rank == 1" class="text-rank-gold pr-2">#{{score.rank}}</span>
                    <span *ngIf="score.rank == 2" class="text-rank-silver pr-2">#{{score.rank}}</span>
                    <span *ngIf="score.rank == 3" class="text-rank-bronze pr-2">#{{score.rank}}</span>

                    <span *ngIf="score.rank !== undefined && score.rank > 3"
                        class="text-rank-other pr-2">#{{score.rank}}</span>
                </div>

                <div class="flex flex-col">
                    <span class="text-lg">{{score.score.toLocaleString(undefined)}} points</span>

                    <span class="text-sm">
                        Achieved by
                        <b>
                            <user-link [user]="score.players[0]"></user-link>
                        </b>
                        {{getMoment(score.scoreSubmitted)}}
                    </span>
                </div>
            </a>
        </div>
    </div>

    <div *ngIf="this.scores !== undefined && this.scores!.length % 10 == 0 && this.scores!.length !== 0">
        <secondary-button text="Load more" (click)="loadMoreScores()"></secondary-button>
    </div>
</div>
