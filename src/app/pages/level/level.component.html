<page-header-block>
    <page-header class="text-3xl">
        {{ level?.Title ?? 'Unnamed Level' }}
        <div class="inline-block text-sm">
            <span-gentle>by <user-link [user]="level!.Publisher" class="pl-1"></user-link></span-gentle>
        </div>
        <div class="text-sm">
            <span-gentle>Published {{ getMoment(level?.PublishDate ?? 0) }}</span-gentle>
            <span-gentle *ngIf="level?.PublishDate != level?.UpdateDate">, updated {{ getMoment(level?.UpdateDate ?? 0)}}</span-gentle>
        </div>
    </page-header>

    <div class="bg-backdrop rounded-[11px] p-2.5">
        <p *ngIf="(level?.Description?.length ?? 0) > 0">{{level?.Description}}</p>
        <p *ngIf="(level?.Description?.length ?? 0) === 0">No description was provided for this level.</p>
    </div>
</page-header-block>

<div class="bg-form-background rounded-[11px] p-5 mt-5">
    <page-header class="text-3xl">Leaderboard</page-header>
    <div class="pt-2.5">
        <form-dropdown name="Score Type" [options]="scoreTypes" [id]="this.scoreTypeId"
            (change)="this.formChanged()"></form-dropdown>
    </div>
    <divider></divider>
    <div *ngIf="scores === undefined">
        <p>Loading scores...</p>
    </div>
    <div *ngIf="scores !== undefined && scores!.length === 0">
        <p>Nobody's played this level in this mode yet. Go for the top score!</p>
    </div>
    <div *ngFor="let score of scores">
        <div class="my-5 px-2.5">
            <a [routerLink]="'/score/' + score.ScoreId" class="flex items-center">
                <div class="text-2xl">
                    <span *ngIf="score.Rank == 1" class="text-rank-gold pr-2">#{{score.Rank}}</span>
                    <span *ngIf="score.Rank == 2" class="text-rank-silver pr-2">#{{score.Rank}}</span>
                    <span *ngIf="score.Rank == 3" class="text-rank-bronze pr-2">#{{score.Rank}}</span>

                    <span *ngIf="score.Rank !== undefined && score.Rank > 3"
                        class="text-rank-other pr-2">#{{score.Rank}}</span>
                </div>

                <div class="flex flex-col">
                    <span class="text-lg">{{score.Score.toLocaleString(undefined)}} points</span>

                    <span class="text-sm">
                        Achieved by
                        <b>
                            <a class="text-indigo-400 hover:text-indigo-300"
                                [routerLink]="'/user/' + score.Players[0].Username">
                                {{score.Players[0].Username}}
                            </a>
                        </b>
                        {{getMoment(score.ScoreSubmitted)}}
                    </span>
                </div>
            </a>
        </div>
    </div>

    <div *ngIf="this.scores !== undefined && this.scores!.length % 10 == 0 && this.scores!.length !== 0">
        <secondary-button text="Load more" (click)="loadMoreScores()"></secondary-button>
    </div>
</div>
